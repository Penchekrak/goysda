# Игра Го на непрерывной доске

## 1. Напоминание: китайские правила Го

1. В начале игры доска пуста.
2. Первый ход делают чёрные, после чего ходы чёрных и белых чередуются.
3. Ход заключается в постановке одного камня на свободный пункт пересечения линий доски.
4. Игрок может в любой момент пропустить ход, за исключением случая, оговоренного в правиле 10.
5. Камень или группа камней одного цвета считаются пленными и снимаются с доски, если все соседние пункты заняты противником. Если такая ситуация возникает одновременно для групп разного цвета, то сохраняется группа игрока, совершившего последний ход, а группа противника снимается.
6. Запрещено делать ход, приводящий к повторению уже существовавшей ранее позиции на доске.
7. Два последовательно пропущенных хода завершают партию.
8. Территория игрока состоит из всех пунктов, которые он занял или окружил. Белым добавляется 6.5 пунктов за право хода вторыми.
9. Игрок, захвативший большую территорию, побеждает.
10*. Если используется форa, белые пропускают первые `n` ходов. Чёрные не должны пропустить ни один из своих первых `n+1` ходов.

---

## 2. Правила этой игры

1. В начале игры доска пуста.
2. Первый ход делают чёрные, после чего ходы чёрных и белых чередуются.
3. Ход заключается в постановке одного камня в любую точку доски, так, чтобы он не пересекался с уже стоящими камнями.  
   **Камни не обязательно ставить на пересечения линий доски**.

   В процессе игры все точки, куда нельзя поставить камень, окрашиваются в отличные от цвета доски цвета. Таким образом, чтобы понять, можно ли поставить камень в определённое место, достаточно взглянуть на цвет точки: если он совпадает с цветом доски — можно, иначе — нельзя.

   Маленькие области, где можно поставить камень, подсвечиваются красными треугольниками.

   Чтобы поставить камень, нажмите левой кнопкой мыши (или один раз на тачпаде) в точку, куда вы хотите поместить центр камня.  
   При наведении мыши будет отображаться предварительный просмотр (preview) позиции.  
   Чтобы включить/отключить preview, нажмите клавишу `G`.

4. Игрок может в любой момент пропустить ход.  
   Для этого в игре нажмите клавишу `P`.

5. Камень или группа камней одного цвета считаются пленными и удаляются с доски, если к ним невозможно присоединить ни один камень.  
   Если такая ситуация возникает одновременно для групп разного цвета, то группа, ход которой был только что сделан, остаётся на доске, а группа противника удаляется.

   > **Примечание:** Места, куда можно присоединить камень к группе, представляют собой границу области вокруг неё.  
   > Большие области хорошо видны глазом, а маленькие подсвечиваются красными треугольниками.

6. Это правило ближе к японским правилам, но может быть изменено в будущих версиях.  
   Если после хода игрока убирается один камень противника, то следующим ходом противнику запрещено убирать только последний камень игрока.

6.5. Также, как и в японских правилах, запрещено ставить камень, который будет немедленно убит по правилу 5.  
   **Однако игроку разрешено ставить камни, которые убивают его собственные камни.**

7. Два последовательных пропущенных хода завершают игру.
8. Территория игрока — это все точки доски, которые ближе к его камням, чем к камням противника.  
   Подсчёт территории происходит автоматически после каждого хода и при перемещении preview камня.

   - За единицу территории принимается площадь квадрата, описывающего камень.  
     Таким образом, если камни ставить только на пересечения, то единица площади будет соответствовать одному пункту по классическим правилам.

   - Чтобы перейти в режим просмотра территории, нажмите `T`.  
     Повторное нажатие `T` выходит из этого режима.

   - Если в игре остаются мёртвые камни, то в конце игроки обычно договариваются, какие из них не учитывать в подсчёте территории.  
     Чтобы пометить группу как мёртвую, перейдите в режим пометки мёртвых камней, нажав `X`, затем кликните на любой камень из группы.  
     Чтобы выйти из режима — нажмите `X` снова.

     > **Важно:** игрок может помечать мёртвыми только камни своего цвета.  
     > Чтобы "оживить" ранее помеченную группу, нажмите на неё в режиме пометки мёртвых камней.

9. Игрок, захвативший большую территорию, побеждает.
10. Правило 10 пока не реализовано, но игроки могут договориться использовать его в игре.

---

## 3. Дополнительные функции и управление

- `Z` — отменить ход.  
- `S` — сохранить игру.  
- `O` — загрузить сохранённую игру. 
- Колёсико мыши — масштабирование. `R` —  перейти в изначальный маштаб (там какой-то баг, иногда колёсиком мышки не возвращается в исходную позицию).
- `Ctrl + движение мыши` — перемещение по доске в увеличенном режиме.  
- `F` — войти/выйти из режима постановки фейковых камней.  
  Фейковые камни не влияют на игру и могут использоваться для анализа позиции или размещения пробных ходов.
---

## 4. Установка и запуск
Склонируйте репозиторий, установите все зависимости из `requirements.txt`, запустить игру `python main.py`.
Можно передать конфиг (можно поменять размер камня, форму доски, коми и т.д.) `python main.py your_config_file`, где содержимое `your_config_file` будет в формате json
Пример такого файла, который создаёт доску в виде правильного 6-угольника, а так же меняет размер камня и коми.
```
{
    "board_polygon": [[0, 320.0], [160.0, 42.87187078897965], [480.0, 42.87187078897965], [640, 320.0], [480.0, 597.1281292110203], [160.0, 597.1281292110203]],
    "stone_radius": 16.842105263157894,
    "komi": 6.9
}
```

### 4.1 Запуск сервера
Запустите `python server.py`. Пока не поддерживается онлайн игра, только игра на одном компьютере в браузере

--- 
## 5. Обрантная связь
Правила и игру можно изменить — я открыт к предложениям, issue-ам и pull request-ам!
